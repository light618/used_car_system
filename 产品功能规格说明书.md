# 集团二手车管理系统 - 产品功能规格说明书

## 一、产品定位

**产品名称**：集团二手车管理系统  
**产品定位**：面向连锁二手车集团的统一管理系统，支持多门店数据隔离、权限管控、车源授权调配  
**目标用户**：集团总部管理员、门店管理员、门店录入员  
**交互端**：PC端（优先）

---

## 二、角色权限体系

### 2.1 角色定义

| 角色 | 权限范围 | 数据可见性 |
|------|---------|-----------|
| **总部管理员** | 最高权限 | 可查看所有门店数据 |
| **门店管理员** | 门店管理权限 + 审核权限 | 仅本店数据 + 授权车源 |
| **门店录入员** | 录入权限 | 仅本店数据（自己录入的） |

### 2.2 权限明细

#### 总部管理员
- ✅ 查看所有门店车源数据
- ✅ 车源授权（A店→B/C店，支持多选）
- ✅ 收回授权
- ✅ 门店管理（创建/修改/删除门店）
- ✅ 创建门店默认账号（录入员+管理员）
- ✅ 重置门店账号密码
- ✅ 修改自己密码
- ❌ 不能录入车源
- ❌ 不能审核车源

#### 门店管理员
- ✅ 查看本店所有车源
- ✅ 查看授权车源（带"他店"标签）
- ✅ 审核本店车源（审核通过/驳回）
- ✅ 修改自己密码
- ✅ 查询筛选（本店/全部/他店）
- ❌ 不能录入车源
- ❌ 不能修改已审核车源

#### 门店录入员
- ✅ 录入车源信息
- ✅ 查看自己录入的车源
- ✅ 修改未审核的车源（所有字段）
- ✅ 修改自己密码
- ❌ 不能查看其他录入员的车源（除非审核通过）
- ❌ 不能修改已审核车源
- ❌ 不能审核车源

---

## 三、核心功能模块

### 3.1 门店管理模块（总部功能）

#### 3.1.1 门店列表
- 显示所有门店信息
- 门店名称、门店编码、门店位置（地址）、门店联系电话、创建时间、状态（启用/禁用）
- 支持搜索、筛选、分页

#### 3.1.2 创建门店
- **必填字段**：
  - 门店名称
  - 门店编码（唯一，不可修改）
  - 门店位置（详细地址）
  - 门店联系电话（用于他店车源显示的联系方式）
- **选填字段**：
  - 门店描述
  - 备注
- 创建成功后自动生成两个默认账号：
  - 门店录入员：`门店编码_luru` / 默认密码
  - 门店管理员：`门店编码_admin` / 默认密码

#### 3.1.3 编辑门店
- 可修改门店信息：
  - 门店名称
  - 门店位置（详细地址）
  - 门店联系电话
  - 门店描述
  - 备注
- **不能修改**：门店编码（唯一标识）

#### 3.1.4 删除门店
- 软删除（标记为已删除，保留历史数据）
- 删除前检查是否有车源数据

#### 3.1.5 门店账号管理
- 查看门店所有账号（包括录入员和管理员账号）
- **重置账号密码**：总部管理员可以针对门店的某个账号重新设置密码
  - 选择门店账号
  - 设置新密码（由总部管理员输入）
  - 重置后新密码显示给总部管理员
- 禁用/启用账号
- **说明**：门店的两个默认账号（录入员和管理员）可以分别修改自己的密码，不受总部重置影响

---

### 3.2 车源管理模块

#### 3.2.1 车源信息字段

**基础信息**
- 品牌（必填）
- 车型/车系（必填）
- 颜色（必填）
- 首次上牌时间（必填）
- 年限（自动计算：当前日期 - 首次上牌时间）
- 车架号（必填，唯一）
- 车牌号（必填）
- 公里数（必填，单位：公里）
- 车况描述（必填，文本）

**图片信息**
- 车辆照片（多张，至少3张，最多20张）
- 绿本照片（至少1张，最多5张）

**收车信息**
- 收车门店（自动，当前登录用户所属门店）
- 收车人员（自动，当前登录用户）
- 收车门店联系电话（自动，从门店信息中获取）
- 收车价（必填，单位：元）
- 收车时间（自动，当前时间）

**状态信息**
- 车源状态（必填）：
  - 收钥匙
  - 已过户
  - 已订
  - 已售出
- 审核状态（自动）：
  - 待审核（默认）
  - 审核通过
  - 审核驳回

**补充字段**
- 车辆型号（选填）
- 排量（选填，单位：L）
- 变速箱类型（选填：手动/自动/手自一体）
- 燃料类型（选填：汽油/柴油/混动/电动）
- 排放标准（选填：国四/国五/国六）
- 过户次数（选填）
- 保险到期时间（选填）
- 年检到期时间（选填）
- 车辆配置（选填，多选：天窗/导航/倒车影像/真皮座椅等）
- 事故记录（选填：无事故/轻微事故/重大事故）
- 维修记录（选填，文本）
- 备注（选填，文本）

**系统字段**
- 录入时间（自动）
- 录入人员（自动）
- 审核时间（自动）
- 审核人员（自动）
- 审核意见（审核驳回时必填）
- 提交总部时间（审核通过后自动）
- 授权门店列表（JSON，存储被授权的门店ID）

---

#### 3.2.2 录入车源（门店录入员）

**功能流程**
1. 点击"新增车源"
2. 填写车源信息表单
3. 上传车辆照片（至少3张）
4. 上传绿本照片（至少1张）
5. 保存草稿（可暂存，不提交审核）
6. 提交审核（状态变为"待审核"）

**权限控制**
- 只能录入到自己的门店
- 未审核前可以修改所有字段
- 审核通过后不能修改
- 审核驳回后可以修改并重新提交

---

#### 3.2.3 审核车源（门店管理员）

**功能流程**
1. 查看待审核车源列表
2. 点击查看车源详情
3. 审核操作：
   - **审核通过**：车源状态变为"审核通过"，自动提交到总部
   - **审核驳回**：必须填写驳回原因，车源状态变为"审核驳回"，录入员可修改后重新提交

**权限控制**
- 只能审核本店车源
- 审核通过后，车源提交到总部，总部可见
- 审核驳回后，录入员可修改

---

#### 3.2.4 查看车源列表

**查询筛选**
- 默认显示：本店车源
- 筛选选项：
  - **本店**：仅显示本店车源
  - **全部**：本店 + 授权车源
  - **他店**：仅显示授权车源（带"他店"标签）

**筛选条件**
- 品牌、车型、颜色
- 车源状态（收钥匙/已过户/已订/已售出）
- 审核状态（待审核/审核通过/审核驳回）
- 收车时间范围
- 收车价范围
- 公里数范围
- 关键词搜索（车牌号/车架号/车型）

**列表显示**
- 车辆照片（第一张）
- 品牌/车型
- 车牌号
- 收车价
- 收车时间
- 车源状态（标签显示）
- 审核状态（标签显示）
- 是否他店车源（标签显示，他店车源显示收车门店联系电话）

**分页**
- 每页20条，支持调整

---

#### 3.2.5 车源详情

**详情页显示**
- 所有车源信息
- 车辆照片（轮播图）
- 绿本照片
- 操作记录（录入时间、审核时间、授权记录等）
- 授权门店列表（如果有）

**权限控制**
- 录入员：只能查看自己录入的车源
- 门店管理员：可查看本店所有车源
- 总部：可查看所有门店车源

---

#### 3.2.6 车源授权（总部功能）

**功能流程**
1. 总部管理员选择车源
2. 点击"授权给门店"
3. 选择目标门店（支持多选）
4. 确认授权

**授权效果**
- 被授权门店可以看到该车源
- 车源显示"他店"标签
- 显示原收车门店名称
- 显示原收车门店联系电话（从门店信息中获取）
- 被授权门店可以联系原收车门店

**权限控制**
- 只有总部管理员可以授权
- 可以授权给多个门店
- 已授权的门店会显示在授权列表中

---

#### 3.2.7 收回授权（总部功能）

**功能流程**
1. 总部管理员查看车源详情
2. 查看授权门店列表
3. 选择要收回授权的门店（支持多选）
4. 确认收回

**收回效果**
- 被收回授权的门店无法再查看该车源
- 车源从被授权门店的列表中移除

---

### 3.3 账号管理模块

#### 3.3.1 登录
- 账号/密码登录
- 记住密码（可选）
- 登录后根据角色跳转到对应页面

#### 3.3.2 修改密码
- **所有角色都可以修改自己的密码**，包括：
  - 总部管理员可以修改自己的密码
  - 门店管理员可以修改自己的密码
  - 门店录入员可以修改自己的密码
- 需要验证原密码
- 新密码强度要求（至少8位，包含字母和数字）

#### 3.3.3 重置密码（总部功能）
- **总部管理员可以针对门店的某个账号进行密码重置**
- 重置操作：总部管理员选择门店账号，重新设置新密码
- 重置后的新密码由总部管理员设置（不是自动生成）
- 重置后，新密码显示给总部管理员，可告知门店账号使用者
- 门店账号（录入员/管理员）可以随时修改自己的密码

---

### 3.4 数据统计模块（总部功能）

#### 4.1 车源统计
- 各门店车源数量
- 车源状态分布（收钥匙/已过户/已订/已售出）
- 审核状态分布（待审核/审核通过/审核驳回）
- 车源增长趋势（按时间）

#### 4.2 门店统计
- 门店车源总数
- 门店活跃度（录入/审核数量）
- 门店销售情况

---

## 四、数据隔离规则

### 4.1 门店数据隔离
- 每个门店的数据完全隔离
- 门店录入员只能看到自己录入的车源（未审核前）
- 门店管理员可以看到本店所有车源
- 门店之间默认不能互相查看

### 4.2 授权机制
- 总部可以将A店车源授权给B/C店
- 授权后，被授权门店可以看到该车源
- 车源显示"他店"标签和原收车门店联系电话（从门店信息中获取）
- 总部可以收回授权

### 4.3 总部权限
- 总部可以看到所有门店的数据
- 总部可以进行车源授权和收回
- 总部可以管理门店和账号

---

## 五、业务流程

### 5.1 车源录入流程
```
录入员录入车源 → 保存草稿/提交审核 → 待审核状态
```

### 5.2 车源审核流程
```
待审核 → 审核员审核 → 审核通过/驳回
  ↓
审核通过 → 自动提交总部 → 总部可见
  ↓
审核驳回 → 录入员修改 → 重新提交审核
```

### 5.3 车源授权流程
```
总部查看车源 → 选择授权门店 → 授权成功 → 被授权门店可见
```

### 5.4 车源收回流程
```
总部查看车源 → 查看授权列表 → 选择收回授权 → 被授权门店不可见
```

---

## 六、技术实现要点

### 6.1 数据隔离实现
- 所有数据表增加 `store_id` 字段（门店ID）
- 查询时根据角色自动添加 `store_id` 过滤条件
- 总部查询时不添加 `store_id` 过滤

### 6.2 授权机制实现
- 创建 `car_authorization` 表存储授权关系
- 查询时关联授权表，判断是否显示

### 6.3 权限控制
- 基于角色的访问控制（RBAC）
- 接口层面验证权限
- 前端页面根据角色显示/隐藏功能

---

## 七、界面设计要求

### 7.1 整体风格
- 简洁、专业、易用
- 响应式设计（适配不同屏幕）

### 7.2 关键页面
- 登录页
- 车源列表页（带筛选）
- 车源详情页
- 车源录入/编辑页
- 门店管理页
- 账号管理页
- 数据统计页

---

## 八、后续扩展功能（暂不实现）

- 移动端（H5/小程序）
- 消息通知
- 操作日志
- 数据导出
- 高级报表

---

主公，以上是完整的产品功能规格说明书，请您审阅确认！

